spring:
  application:
    name: bt-search

  datasource:
    url: jdbc:mysql://mysqlnew:3306/forge?useSSL=false&serverTimezone=UTC&characterEncoding=utf8mb4
    username: root
    password: Shijin1221.nb
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        fetch_size: 1000

  data:
    elasticsearch:
      client:
        endpoints: bt-search-es:9200

  elasticsearch:
    rest:
      connection-timeout: 5s
      read-timeout: 30s

  redis:
    host: redis
    port: 6379
    database: 0
    timeout: 10s
    lettuce:
      pool:
        max-active: 20
        max-idle: 10
        min-idle: 5
      shutdown-timeout: 100ms

  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=10000,expireAfterWrite=10m

# 应用配置
bt-search:
  sync:
    enabled: true
    batch-size: 5000
    bulk-size: 500
    interval: 300000  # 5分钟
  cache:
    search-result-ttl: 600  # 10分钟
    torrent-detail-ttl: 86400  # 24小时
    hot-keywords-ttl: 3600  # 1小时
    language-detection-ttl: 86400  # 24小时
  search:
    max-results: 100
    default-page-size: 20
  elasticsearch:
    index-name: torrents

# 日志配置
logging:
  level:
    root: INFO
    com.btsearch: DEBUG
    org.springframework.data.elasticsearch: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# 管理端点
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always
